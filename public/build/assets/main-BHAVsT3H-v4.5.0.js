import{S as o,M as d,N as l,T as y,P as w}from"./swiper-BxwyBx_L-v4.5.0.js";import{m as f}from"./blueimp-md5-CGBD6urz-v4.5.0.js";import{D as c}from"./drift-zoom-KJ3HkKpL-v4.5.0.js";import{G as b}from"./glightbox-E81OpMix-v4.5.0.js";import{E as P}from"./Errors-C30A2Jtx-v4.5.0.js";import"./ProductRating-B-YFAG_Q-v4.5.0.js";import"./Pagination-DKj6Zlmg-v4.5.0.js";import"./ProductCard-fXPfQTF2-v4.5.0.js";import"./@popperjs-DMMwm23M-v4.5.0.js";import"./ProductMixin-B338t0Tz-v4.5.0.js";let r,u,n=[];Alpine.data("ProductShow",({product:h,variant:m,reviewCount:p,avgRating:g})=>({product:h,item:m||h,addingToCart:!1,oldMediaLength:null,activeVariationValues:{},variationImagePath:null,showDescriptionContent:!1,showMore:!1,fetchingReviews:!1,reviews:{},reviewCount:p,avgRating:g,addingNewReview:!1,reviewForm:{},currentPage:1,cartItemForm:{product_id:h.id,qty:1,variations:{},options:{}},errors:new P,get productName(){return this.product.name},get isActiveItem(){return this.item.is_active===!0},get productUrl(){return route("products.show",{slug:this.product.slug,...this.hasAnyVariant&&{variant:this.item.uid}})},get hasAnyMedia(){return this.item.media.length!==0},get productPrice(){return this.item.formatted_price},get isInStock(){return this.item.is_in_stock},get isOutOfStock(){return this.item.is_out_of_stock},get doesManageStock(){return this.item.does_manage_stock},get hasAnyVariationImage(){return this.variationImagePath!==null},get inWishlist(){return this.$store.state.inWishlist(this.product.id)},get inCompareList(){return this.$store.state.inCompareList(this.product.id)},get hasAnyVariant(){return this.product.variant!==null},get hasAnyOption(){return this.product.options.length>0},get isAddToCartDisabled(){return this.isActiveItem?this.isOutOfStock:!0},get maxQuantity(){return this.isInStock&&this.doesManageStock?this.item.qty:null},get isQtyIncreaseDisabled(){return this.isOutOfStock||this.maxQuantity!==null&&this.cartItemForm.qty>=this.item.qty||!this.isActiveItem},get isQtyDecreaseDisabled(){return this.isOutOfStock||this.cartItemForm.qty<=1||!this.isActiveItem},get totalReviews(){return this.reviews.total?this.reviews.total:this.reviewCount},get ratingPercent(){return this.avgRating/5*100},get emptyReviews(){return this.totalReviews===0},get totalPage(){return Math.ceil(this.reviews.total/5)},init(){r=this.initGalleryPreviewSlider(),u=this.initGalleryPreviewLightbox(),this.fetchReviews(),this.setOldMediaLength(),this.initGalleryPreviewZoom(),this.setActiveVariationsValue(),this.setDescriptionContentHeight(),this.initUpSellProductsSlider(),this.initRelatedProductsSlider()},syncWishlist(){this.$store.state.syncWishlist(this.product.id)},syncCompareList(){this.$store.state.syncCompareList(this.product.id)},setOldMediaLength(){this.hasAnyVariant&&(this.oldMediaLength=this.item.media.length)},initGalleryPreviewSlider(){return new o(".product-gallery-preview",{modules:[d,l,y],slidesPerView:1,allowTouchMove:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:this.initGalleryThumbnailSlider()}})},initGalleryThumbnailSlider(){return new o(".product-gallery-thumbnail",{modules:[d,l],slidesPerView:4,spaceBetween:10,watchSlidesProgress:!0,touchEventsTarget:"container",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{450:{slidesPerView:6},576:{slidesPerView:7},992:{slidesPerView:6},1600:{slidesPerView:7}}})},updateGallerySlider(){this.removeAllGallerySlides(),this.product.media.length===0&&!this.hasAnyMedia?this.addGalleryEmptySlide():this.addGallerySlides(),this.addGalleryEventListeners()},addGallerySlides(){const e=[],t=[];[...this.item.media,...this.product.media].forEach(({path:i})=>{e.unshift(this.galleryPreviewSlide(i)),t.unshift(this.galleryThumbnailSlide(i))}),r.addSlide(0,e),r.thumbs.swiper.addSlide(0,t),r.slideTo(0),r.thumbs.swiper.slideTo(0)},addGalleryEmptySlide(){const e=`${FleetCart.baseUrl}/build/assets/image-placeholder.png`;r.addSlide(0,this.galleryPreviewEmptySlide(e)),r.thumbs.swiper.addSlide(0,this.galleryThumbnailEmptySlide(e))},removeAllGallerySlides(){r.removeAllSlides(),r.thumbs.swiper.removeAllSlides()},addGalleryEventListeners(){this.$nextTick(()=>{this.initGalleryPreviewZoom(),u.reload()})},initGalleryPreviewZoom(){if(this.isMobileDevice()){this.initGalleryPreviewMobileZoom();return}this.initGalleryPreviewDesktopZoom()},initGalleryPreviewMobileZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(e=>{n.push(new c(e,{namespace:"mobile-drift",inlinePane:!0,inlineOffsetY:-55,passive:!1}))})},initGalleryPreviewDesktopZoom(){this.destroyGalleryPreviewZoomInstances(),[...document.querySelectorAll(".gallery-preview-item > img")].forEach(e=>{n.push(new c(e,{inlinePane:!1,hoverBoundingBox:!0,boundingBoxContainer:document.body,paneContainer:document.querySelector(".product-gallery")}))})},destroyGalleryPreviewZoomInstances(){n.length!==0&&n.forEach(e=>{e.destroy()})},initGalleryPreviewLightbox(){return b({zoomable:!0,preload:!1})},triggerGalleryPreviewLightbox(e){window.innerWidth>990&&e.currentTarget.nextElementSibling.click()},galleryPreviewSlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${e}" data-zoom="${e}" alt="${this.productName}">
                        </div>

                        <a href="${e}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailSlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${e}" alt="${this.productName}">
                        </div>
                    </div>
                </div>
            `},galleryPreviewEmptySlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-preview-slide">
                        <div class="gallery-preview-item" @click="triggerGalleryPreviewLightbox(event)">
                            <img src="${e}" data-zoom="${e}" alt="${this.productName}" class="image-placeholder">
                        </div>

                        <a href="${e}" data-gallery="product-gallery-preview" class="gallery-view-icon glightbox">
                            <i class="las la-search-plus"></i>
                        </a>
                    </div>
                </div>
            `},galleryThumbnailEmptySlide(e){return`
                <div class="swiper-slide">
                    <div class="gallery-thumbnail-slide">
                        <div class="gallery-thumbnail-item">
                            <img src="${e}" alt="${this.productName}" class="image-placeholder">
                        </div>
                    </div>
                </div>
            `},isVariationValueEnabled(e,t,i){if(t===0)return this.doesVariantExist(i);if(t>0&&t<this.product.variations.length-1)return this.doesVariantExist(i);if(t===this.product.variations.length-1){const s=this.cartItemForm.variations,a=Object.values(s).filter(v=>v!==s[e]);return a.push(i),this.doesVariantExist(a.sort().join("."))}},setActiveVariationsValue(){this.hasAnyVariant&&this.item.uids.split(".").forEach(e=>{this.product.variations.some(t=>{const i=t.values.find(s=>s.uid===e);if(i!==void 0)return this.activeVariationValues[t.uid]=i.label,this.cartItemForm.variations[t.uid]=e,!0})})},setActiveVariationValueLabel(e){this.variationImagePath=null;const t=this.product.variations[e],i=t.values.find(s=>s.uid===this.cartItemForm.variations[t.uid]);this.activeVariationValues[t.uid]=i.label},setVariationValueLabel(e,t){const i=this.product.variations[e],s=i.values[t];!this.isMobileDevice()&&i.type==="image"&&(this.variationImagePath=s.image.path),this.activeVariationValues[i.uid]=s.label},isActiveVariationValue(e,t){return this.cartItemForm.variations.hasOwnProperty(e)?this.cartItemForm.variations[e]===t:!1},syncVariationValue(e,t,i,s){this.isActiveVariationValue(e,i)||(this.cartItemForm.variations[e]=i,this.setVariationValueLabel(t,s),this.updateVariantDetails())},doesVariantExist(e){return this.product.variants.some(({uids:t})=>t.includes(e))},setVariant(){const e=Object.values(this.cartItemForm.variations).sort().join("."),t=this.product.variants.find(s=>s.uids===e);if(t!==void 0){this.item={...t},this.reduceToMaxQuantity();return}const i=f(Object.values(this.cartItemForm.variations).sort().join("."));this.item={uid:i,media:[],base_image:[]},this.cartItemForm.qty=1},setVariantSlug(){const e=route("products.show",{slug:this.product.slug,variant:this.item.uid});window.history.replaceState({},"",e)},updateVariantDetails(){this.setOldMediaLength(),this.setVariant(),this.setVariantSlug(),this.updateGallerySlider()},updateSelectTypeOptionValue(e,t){this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:t.target.value}),this.errors.clear(`options.${e}`)},updateCheckboxTypeOptionValue(e,t){let i=$(t.target).parents(".variant-check").find('input[type="checkbox"]:checked').map((s,a)=>a.value);this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:i.get()})},customRadioTypeOptionValueIsActive(e,t){return this.cartItemForm.options.hasOwnProperty(e)?this.cartItemForm.options[e]===t:!1},syncCustomRadioTypeOptionValue(e,t){this.customRadioTypeOptionValueIsActive(e,t)?delete this.cartItemForm.options[e]:(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:t}),this.errors.clear(`options.${e}`))},customCheckboxTypeOptionValueIsActive(e,t){return this.cartItemForm.options.hasOwnProperty(e)?this.cartItemForm.options[e].includes(t):(this.cartItemForm.options=Object.assign({},this.cartItemForm.options,{[e]:[]}),!1)},syncCustomCheckboxTypeOptionValue(e,t){this.customCheckboxTypeOptionValueIsActive(e,t)?this.cartItemForm.options[e].splice(this.cartItemForm.options[e].indexOf(t),1):(this.cartItemForm.options[e].push(t),this.cartItemForm=Object.assign({},this.cartItemForm,this.cartItemForm.options),this.errors.clear(`options.${e}`))},setDescriptionContentHeight(){this.$nextTick(()=>{this.showMore=this.$refs.descriptionContent.clientHeight>=400})},setInactiveItemData(){this.item={uid:this.item.uid,media:[],base_image:[]}},isMobileDevice(){return window.matchMedia("only screen and (max-width: 992px)").matches},updateQuantity(e){if(isNaN(e)||e<1){this.cartItemForm.qty=1;return}if(this.cartItemForm.qty=e,this.exceedsMaxStock(e)){this.cartItemForm.qty=this.item.qty;return}},exceedsMaxStock(e){return this.doesManageStock&&this.item.qty<e},reduceToMaxQuantity(){this.doesManageStock&&this.cartItemForm.qty>this.item.qty&&(this.cartItemForm.qty=this.item.qty||1)},addToCart(){this.isAddToCartDisabled||(this.addingToCart=!0,axios.post(route("cart.items.store"),{...this.cartItemForm,...this.hasAnyVariant&&{variant_id:this.item.id}}).then(e=>{this.$store.state.updateCart(e.data),this.$store.layout.openSidebarCart()}).catch(({response:e})=>{e.status===422&&this.errors.record(e.data.errors),notify(e.data.message)}).finally(()=>{this.addingToCart=!1}))},toggleDescriptionContent(){this.showDescriptionContent=!this.showDescriptionContent},async fetchReviews(){this.fetchingReviews=!0;try{const e=await axios.get(route("products.reviews.index",{productId:this.product.id,page:this.currentPage}));this.reviews=e.data}catch(e){notify(e.response.data.message)}finally{this.fetchingReviews=!1}},addNewReview(){this.addingNewReview=!0,axios.post(route("products.reviews.store",{productId:this.product.id}),{...this.reviewForm,...window.grecaptcha&&{"g-recaptcha-response":grecaptcha.getResponse()}}).then(e=>{this.reviewForm={},this.reviews.total++,this.reviews.data.unshift(e.data),notify(trans("storefront::product.review_submitted")),this.errors.reset()}).catch(({response:e})=>{if(e.status===422){this.errors.record(e.data.errors);return}notify(e.data.message)}).finally(()=>{this.addingNewReview=!1,window.grecaptcha&&grecaptcha.reset()})},changePage(e){this.currentPage=e,this.fetchReviews()},hideRelatedProductsSkeleton(){document.querySelectorAll(".landscape-products .swiper-slide-skeleton").forEach(t=>t.remove())},initUpSellProductsSlider(){new o(this.$refs.upSellProducts,{modules:[l],slidesPerView:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},initRelatedProductsSlider(){this.hideRelatedProductsSkeleton(),new o(this.$refs.landscapeProducts,{modules:[l,w],slidesPerView:2,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",dynamicBullets:!0,clickable:!0},breakpoints:{640:{slidesPerView:3},880:{slidesPerView:4},992:{slidesPerView:3},1100:{slidesPerView:4},1300:{slidesPerView:5},1600:{slidesPerView:6}}})}}));
